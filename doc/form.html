<!DOCTYPE html>
<html>

<head>
    <link href="gb.png" rel="icon" type="image/png" />
    <meta charset="UTF-8">
    <title>Substituir Palavras-Chave</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <form>
        <label for="NAME_1Input">Digite o NOME:</label>
        <input type="text" id="NAME_1Input">
        <br>

        <label for="cpInput">Digite o CPF:</label>
        <input type="text" id="cpInput">
        <br>

        <label for="enderecoInput">Digite o ENDEREÇO:</label>
        <input type="text" id="enderecoInput">
        <br>

        <label for="END_1Input">Digite o ESTADO:</label>
        <input type="text" id="END_1Input">
        <br>
        
        <label for="CI_1Input">Digite o CIDADE:</label>
        <input type="text" id="CI_1Input">
        <br>

        <label for="CE_1Input">Digite o CEP:</label>
        <input type="text" id="CE_1Input">
        <br>

        <label for="LIST_1Input">Painéis (quantidade e tipo):</label>
        <input type="text" id="LIST_1Input">
        <br>

        <label for="LIST_2Input">Inversor (quantidade e tipo):</label>
        <input type="text" id="LIST_2Input">
        <br>

        <label for="METRO_1Input">CABO SOLAR (METRO):</label>
        <input type="text" id="METRO_1Input">
        <br>

    </form>
    <button onclick="substituirPalavrasChave()">Substituir Palavras-Chave</button>
    <br>
    <div id="guiContainer"></div>

    <script>
        function substituirPalavrasChave() {
            const cpValue = document.getElementById("cpInput").value;
            const enderecoValue = document.getElementById("enderecoInput").value;
            const NAME_1Value = document.getElementById("NAME_1Input").value;
            const END_1Value = document.getElementById("END_1Input").value;
            const CE_1Value = document.getElementById("CE_1Input").value; 
            const CI_1Value = document.getElementById("CI_1Input").value;
            const LIST_1Value = document.getElementById("LIST_1Input").value;
            const LIST_2Value = document.getElementById("LIST_2Input").value;
            const METRO_1Value = document.getElementById("METRO_1Input").value;

            const today = new Date();
            const day = today.getDate();
            const year = today.getFullYear();
            const monthNames = [
                "Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho",
                "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"
            ];
            const month = monthNames[today.getMonth()];

            fetch("conclusão.html")
                .then(response => response.text())
                .then(html => {
                    const htmlComSubstituicoes = html
                        .replace(/CP_1/g, cpValue)
                        .replace(/END_1/g, enderecoValue)
                        .replace(/CE_1/g, CE_1Value)
                        .replace(/ES_1/g, END_1Value)
                        .replace(/NAME_1/g, NAME_1Value)
                        .replace(/NAME_2/g, NAME_1Value)
                        .replace(/CI_1/g, CI_1Value)
                        .replace(/DT_1/g, day)
                        .replace(/MT_1/g, month)
                        .replace(/AT_1/g, year)
                        .replace(/LIST_1/g, LIST_1Value)
                        .replace(/LIST_2/g, LIST_2Value)
                        .replace(/METRO_1/g, METRO_1Value);

                    // Cria um blob com o conteúdo modificado
                    const blob = new Blob([htmlComSubstituicoes], {
                        type: "text/html"
                    });

                    // Cria uma URL temporária para o blob
                    const url = URL.createObjectURL(blob);

                    // Cria um link de download
                    const downloadLink = document.createElement("a");
                    downloadLink.href = url;
                    downloadLink.download = NAME_1Value,".html";
                    downloadLink.textContent = "Baixar Arquivo Modificado";

                    // Adiciona o link à página
                    const guiContainer = document.getElementById("guiContainer");
                    guiContainer.innerHTML = "";
                    guiContainer.appendChild(downloadLink);
                })
                .catch(error => {
                    console.error("Erro ao carregar o arquivo Gui.html:", error);
                });
        }
    </script>
</body>

</html>